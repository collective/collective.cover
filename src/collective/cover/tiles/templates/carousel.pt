<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="collective.cover">

<head>
  <link rel="stylesheet" type="text/css"
      tal:attributes="href string:${context/@@plone_portal_state/portal_url}/++resource++collective.cover/cycle2-theme/cycle2.cover_theme.css" />

</head>

<body tal:define="is_empty view/is_empty">

  <p tal:condition="python: is_empty and view.is_compose_mode()" i18n:translate="">
    This carousel is empty; open the content chooser and drag-and-drop some items here.
  </p>

  <div
      id=""
      class="cycle2-carousel cover-carousel-tile tile-content"
      data-cycle-timeout="4000"
      data-cycle-center-horz="true"
      data-cycle-center-vert="true"
      data-cycle-paused="true"
      data-cycle-pause-on-hover="true"
      data-cycle-slides="> div.slide"
      data-cycle-swipe="true"
      data-cycle-swipe-fx="scrollHorz"
      data-cycle-pager=".cycle-pager"
      tal:condition="not:is_empty"
      tal:attributes="id string:cycle-${view/id};
                      data-cycle-paused view/paused|default;
                      data-cycle-pager-template view/pagertemplate;">
    <div class="cycle-prev"></div>
    <div class="cycle-next"></div>

    <tal:items repeat="item view/results">
      <div class="slide"
           tal:define="slideimg python:view.thumbnail(item);
                       thumbnail python: view.pagerthumbnail(item);"
           tal:attributes="data-uid python:view.get_uid(item);
                           data-thumbnail python: thumbnail and thumbnail.url or None;
                           data-title item/Title;
                           data-desc item/Description;">
          <tal:image condition="python:slideimg">
            <a href="#"
               tal:attributes="href item/absolute_url;">
              <img tal:attributes="src slideimg/url|string:${item/absolute_url}/download;
                                   width slideimg/width;
                                   height slideimg/height;
                                   alt item/Title;" />
            </a>
          </tal:image>
        <div class="non-image-fields">
          <tal:fields repeat="field view/get_configured_fields">
            <h2 class="tile-item-title"
                tal:condition="python:field['id'] == 'title'"
                tal:replace="structure python:view.get_title_tag(item)"
                />

            <p class="slide-desc"
               tal:condition="python:field['id'] == 'description'"
               tal:content="item/Description"
               />
            <p class="slide-datetime"
               tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime"
               tal:condition="python:field['id'] == 'date'"
               tal:content="python:toLocalizedTime(view.Date(item), True)"
               />
          </tal:fields>
        </div>
      </div>
    </tal:items>
  </div>
  <div class="cycle-pager-container"
       tal:attributes="class string:cycle-pager-container ${view/pagerclass};">
    <div class="cycle-pager"></div>
  </div>
  <script type="text/javascript"
          tal:condition="not:is_empty">
    $( '.cycle2-carousel' ).cycle();
  </script>
</body>
</html>
